<div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8" data-controller="ss-planner">

  <%# Page Header (sticky) %>
  <div class="sticky top-14 z-20 bg-gray-50 dark:bg-gray-900 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 py-4 mb-2 border-b border-gray-200 dark:border-gray-700 shadow-sm">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
      <div>
        <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Social Security Benefit Planner</h1>
        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Estimate your optimal Social Security claiming strategy. All calculations are client-side only — nothing is saved.</p>
      </div>
    </div>
  </div>

  <%# Assumptions %>
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm ring-1 ring-gray-200 dark:ring-gray-700 p-6 mb-6">
    <h2 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Assumptions</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">COLA (Cost-of-Living Adjustment) %</label>
        <input type="number" step="0.1" value="2.5" min="0" max="10"
               data-ss-planner-target="colaRate"
               data-action="change->ss-planner#recalculate"
               class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
      </div>
    </div>
  </div>

  <%# Participants: You %>
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm ring-1 ring-gray-200 dark:ring-gray-700 p-6 mb-6">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-lg font-semibold text-gray-900 dark:text-white">You</h2>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name</label>
        <input type="text" placeholder="Your name"
               data-ss-planner-target="yourName"
               class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Sex</label>
        <select data-ss-planner-target="yourSex" data-action="change->ss-planner#recalculate"
                class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Birthdate</label>
        <input type="date"
               data-ss-planner-target="yourBirthdate"
               data-action="change->ss-planner#recalculate"
               class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Primary Insurance Amount (PIA) $/mo</label>
        <input type="number" step="1" min="0" placeholder="e.g. 2800"
               data-ss-planner-target="yourPIA"
               data-action="change->ss-planner#recalculate"
               class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Planned Claim Age</label>
        <div class="flex space-x-2">
          <select data-ss-planner-target="yourClaimAgeYears" data-action="change->ss-planner#recalculate"
                  class="flex-1 rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
            <% (62..70).each do |age| %>
              <option value="<%= age %>" <%= "selected" if age == 67 %>><%= age %> years</option>
            <% end %>
          </select>
          <select data-ss-planner-target="yourClaimAgeMonths" data-action="change->ss-planner#recalculate"
                  class="w-24 rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
            <% (0..11).each do |m| %>
              <option value="<%= m %>"><%= m %> mo</option>
            <% end %>
          </select>
        </div>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Currently Drawing?</label>
        <select data-ss-planner-target="yourCurrentlyDrawing"
                class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
          <option value="no">No</option>
          <option value="yes">Yes</option>
        </select>
      </div>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4 pt-4 border-t border-gray-100 dark:border-gray-700">
      <div>
        <p class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Full Retirement Age (FRA)</p>
        <p class="text-sm font-semibold text-gray-900 dark:text-white leading-tight" data-ss-planner-target="yourFRA">—</p>
      </div>
      <div>
        <p class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Life Expectancy</p>
        <p class="text-sm font-semibold text-gray-900 dark:text-white leading-tight" data-ss-planner-target="yourLifeExpectancy">—</p>
        <p class="text-xs text-gray-400 dark:text-gray-500 mt-0.5">Based on <a href="https://www.ssa.gov/oact/STATS/table4c6.html" target="_blank" rel="noopener" class="text-brand-600 dark:text-brand-400 hover:underline">Social Security Administration Period Life Table (2022)</a>.</p>
      </div>
    </div>
    <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-700">
      <button type="button" data-action="click->ss-planner#toggleSpouse"
              class="inline-flex items-center px-4 py-2 text-sm font-medium text-brand-600 dark:text-brand-400 bg-brand-50 dark:bg-brand-900/30 hover:bg-brand-100 dark:hover:bg-brand-800 rounded-lg transition">
        <svg class="h-4 w-4 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/>
        </svg>
        Add / Remove Spouse
      </button>
    </div>
  </div>

  <%# Participants: Spouse (hidden by default) %>
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm ring-1 ring-gray-200 dark:ring-gray-700 p-6 mb-6 hidden" data-ss-planner-target="spouseSection">
    <h2 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Spouse</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name</label>
        <input type="text" placeholder="Spouse name"
               data-ss-planner-target="spouseName"
               class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Sex</label>
        <select data-ss-planner-target="spouseSex" data-action="change->ss-planner#recalculate"
                class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
          <option value="female">Female</option>
          <option value="male">Male</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Birthdate</label>
        <input type="date"
               data-ss-planner-target="spouseBirthdate"
               data-action="change->ss-planner#recalculate"
               class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Primary Insurance Amount (PIA) $/mo</label>
        <input type="number" step="1" min="0" placeholder="e.g. 1800"
               data-ss-planner-target="spousePIA"
               data-action="change->ss-planner#recalculate"
               class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Planned Claim Age</label>
        <div class="flex space-x-2">
          <select data-ss-planner-target="spouseClaimAgeYears" data-action="change->ss-planner#recalculate"
                  class="flex-1 rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
            <% (62..70).each do |age| %>
              <option value="<%= age %>" <%= "selected" if age == 67 %>><%= age %> years</option>
            <% end %>
          </select>
          <select data-ss-planner-target="spouseClaimAgeMonths" data-action="change->ss-planner#recalculate"
                  class="w-24 rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
            <% (0..11).each do |m| %>
              <option value="<%= m %>"><%= m %> mo</option>
            <% end %>
          </select>
        </div>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Currently Drawing?</label>
        <select data-ss-planner-target="spouseCurrentlyDrawing"
                class="w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm focus:ring-brand-500 focus:border-brand-500">
          <option value="no">No</option>
          <option value="yes">Yes</option>
        </select>
      </div>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4 pt-4 border-t border-gray-100 dark:border-gray-700">
      <div>
        <p class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Full Retirement Age (FRA)</p>
        <p class="text-sm font-semibold text-gray-900 dark:text-white leading-tight" data-ss-planner-target="spouseFRA">—</p>
      </div>
      <div>
        <p class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Life Expectancy</p>
        <p class="text-sm font-semibold text-gray-900 dark:text-white leading-tight" data-ss-planner-target="spouseLifeExpectancy">—</p>
        <p class="text-xs text-gray-400 dark:text-gray-500 mt-0.5">Based on <a href="https://www.ssa.gov/oact/STATS/table4c6.html" target="_blank" rel="noopener" class="text-brand-600 dark:text-brand-400 hover:underline">Social Security Administration Period Life Table (2022)</a>.</p>
      </div>
    </div>
  </div>

  <%# Strategy Summary %>
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm ring-1 ring-gray-200 dark:ring-gray-700 p-6 mb-6">
    <h2 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Strategy Summary</h2>
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
      <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 text-center">
        <p class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Optimal Claiming Age (You)</p>
        <p class="text-lg font-bold text-gray-900 dark:text-white leading-tight" data-ss-planner-target="yourOptimal">—</p>
      </div>
      <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 text-center">
        <p class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Optimal Claiming Age (Spouse)</p>
        <p class="text-lg font-bold text-gray-900 dark:text-white leading-tight" data-ss-planner-target="spouseOptimal">—</p>
      </div>
      <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 text-center">
        <p class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1">Projected Lifetime Value</p>
        <p class="text-lg font-bold text-green-600 dark:text-green-400" data-ss-planner-target="projectedValue">—</p>
      </div>
    </div>

    <%# Strategy Table %>
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
        <thead class="bg-gray-50 dark:bg-gray-800">
          <tr>
            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Person</th>
            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Claim Age</th>
            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Benefit %</th>
            <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Monthly</th>
            <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Annual</th>
            <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Lifetime Value</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-100 dark:divide-gray-700" data-ss-planner-target="strategyTableBody">
          <tr><td colspan="6" class="px-4 py-6 text-center text-sm text-gray-400">Enter your PIA and birthdate to see strategies.</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <%# Timeline Visualization %>
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm ring-1 ring-gray-200 dark:ring-gray-700 p-6 mb-6">
    <h2 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Lifetime Value by Claim Age</h2>
    <div data-ss-planner-target="timelineChart" class="w-full">
      <p class="text-sm text-gray-400 dark:text-gray-500 text-center py-8">Enter your details above to see the timeline visualization.</p>
    </div>
  </div>

  <%# Bottom Action Bar (sticky) %>
  <div class="sticky bottom-0 z-20 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 py-3 shadow-lg">
    <div class="flex items-center justify-end space-x-3">
      <button type="button" disabled
              class="px-5 py-2 text-sm font-medium text-gray-400 dark:text-gray-500 bg-gray-100 dark:bg-gray-700 rounded-lg cursor-not-allowed"
              title="Coming soon — no data is saved in this version">
        Save Scenario
      </button>
      <button type="button" disabled
              class="px-5 py-2 text-sm font-medium text-gray-400 dark:text-gray-500 bg-gray-100 dark:bg-gray-700 rounded-lg cursor-not-allowed"
              title="Coming soon">
        Export PDF Report
      </button>
      <button type="button"
              data-action="click->ss-planner#resetScenario"
              class="px-5 py-2 text-sm font-medium text-white bg-brand-600 hover:bg-brand-700 rounded-lg shadow-sm transition">
        Compare Another Scenario
      </button>
    </div>
  </div>
</div>
